<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>我爱解析资源站检测 - 52解析_52.jx.cn</title>
    <link href="css/check.css" rel="stylesheet" type="text/css">
    <script type="text/javascript" src="js/jquery.min.js"></script>
    <script type="text/javascript" src="js/url.js"></script>
    <script src="js/sweetalert2@11"></script>
    <script type="text/javascript">
    var checked=false;
        String.prototype.hashCode = function() {
          var hash = 0, i, chr;
          if (this.length === 0) return hash;
          for (i = 0; i < this.length; i++) {
            chr   = this.charCodeAt(i);
            hash  = ((hash << 5) - hash) + chr;
            hash |= 0; // Convert to 32bit integer
          }
          return (hash & 0x7FFFFFFF);
        //   return hash;
        };
        $(function(){
            let html = ''
            jks.forEach((item,index)=>{
                let id = item.title.hashCode()
                html+=`<div class="lbl">
                    <label for="name" id="${id}" class="valid-none" data-title="${item.title}" data-url="${item.url}">${item.title}<b style="color:red">(待核实)</b></label>
                </div>
                <div class="ctrl">
                    <input type="text" name="name" data-required="true" data-validation="text"
                        data-msg="Invalid Name" placeholder="Ex: John Donga" value="${item.url}" disabled>
                </div>`
            })
            $("#formbody").append(html)
            letcheckUrl = function (url) {
                  return new Promise(function (resolve, reject) {
                    $.ajax({
                      url: url,
                      type: 'GET',
                      dataType: "jsonp", //跨域采用jsonp方式
                      complete: (response)=> {
                        resolve(true)
                        if(response.status==200)
                          resolve(true)
                        else
                          resolve(false)
                      }
                      
                    });
                  });
            }
            $("#start_check").click(function(){
                if(!jks){
                    alert(`接口未载入`)
                }
                checked=true;
                jks.forEach((item,index)=>{
                    let id = item.title.hashCode()
                    letcheckUrl(item.url).then((res)=>{
                    $("#"+id).html(`${item.title}<b style="color:green">(正常)</b>`).removeClass("valid-none").addClass("valid-true")
                    })
                })
            })
            $("#report").click(function(){
                if(!checked){
                    Swal.fire('还没检测过哦')
                    return
                }
                let unvalids=$(".valid-none")
                if(unvalids){
                    let unvalid_infos='';
                    $(unvalids).each((index,item)=>{
                        unvalid_infos+=`${$(item).data('title')}:${$(item).data('url')}<br>`
                        })
                    unvalid_infos.trim(',')
                    Swal.fire({
                      title: '发现异常',
                      html: `本次检测到[${unvalids.length}]个接口异常,是否要上报？<br>请复制下列信息:<br>${unvalid_infos}`,
                      icon: 'warning',
                      showCancelButton: true,
                      confirmButtonColor: '#3085d6',
                      cancelButtonColor: '#d33',
                      confirmButtonText: '好的,出份力',
                      cancelButtonText:'算了我才不管'
                    }).then((result) => {
                      if (result.isConfirmed) {
                        window.open('http://wpa.qq.com/msgrd?v=3&uin=2770887228&site=qq&menu=yes')
                      }
                    })
                }else{
                    Swal.fire('没检测到失效接口哦')
                }
            })
        })
    </script>
</head>
<body>
    <section id="getintouch" class="fadeInRightBig animated">
        <div class="container" style="border-bottom: 0;">
            <h1>
                <span>我爱解析资源站检测 — 52解析_52.jx.cn</span>
            </h1>
			
        </div>
        <div class="container">
            <form class="contact" action="#" method="post" id="form">
            <h2>
                <span>点击开始检测按钮，出现红色待核实说明此接口出现问题</span>
            </h2>			
                        <div class="row  clearfix">
                <div class="span10 offset2">
                    <input type="button" class="submit" value="点我检测" id="start_check">
                    <input type="button" class="submit" value="上报结果" id="report">
                </div>
            </div>
            <div class="row clearfix" id="formbody">
            </div>
            </form>
        </div>
    </section>
	
<!--安全2不要扒我了开始-->
<script type="text/javascript">
((function() {
    var callbacks = [],
        timeLimit = 50,
        open = false;
    setInterval(loop, 1);
    return {
        addListener: function(fn) {
            callbacks.push(fn);
        },
        cancleListenr: function(fn) {
            callbacks = callbacks.filter(function(v) {
                return v !== fn;
            });
        }
    }
    function loop() {
        var startTime = new Date();
        debugger;
        if (new Date() - startTime > timeLimit) {
            if (!open) {
                callbacks.forEach(function(fn) {
                    fn.call(null);
                });
            }
            open = true;
            window.stop();
            alert('我爱解析温馨提醒：\n小伙子！你想干嘛？\n不要扒我了~');
            window.location.reload();
        } else {
            open = false;
        }
    }
})()).addListener(function() {
    window.location.reload();
});
// js键盘监听事件-监听键盘F12(123)-触发文件为空
$(document).keydown(function(event) {
	if (event.keyCode == 123) {
		alert('我爱解析温馨提醒：\n小伙子！你想干嘛？\n又想扒我呀？');
		document.body.innerHTML = "";
	}
});
</script>
<!--禁止审查代码start-->
<script type="text/javascript">
		//判断F12审查元素
function fuckyou() {
	window.close(); //关闭当前窗口(防抽)
	window.location = "about:blank"; //将当前窗口跳转置空白页
}

function ck() {
	console.profile();
	console.profileEnd();
	//我们判断一下profiles里面有没有东西，如果有，肯定有人按F12了，没错！！
	if(console.clear) {
		console.clear()
	};
	if(typeof console.profiles == "object") {
		return console.profiles.length > 0;
	}
}

function hehe() {
	if((window.console && (console.firebug || console.table && /firebug/i.test(console.table()))) || (typeof opera == 'object' && typeof opera.postError == 'function' && console.profile.length > 0)) {
		fuckyou();
	}
	if(typeof console.profiles == "object" && console.profiles.length > 0) {
		fuckyou();
	}
}
hehe();
window.onresize = function() {
	if((window.outerHeight - window.innerHeight) > 200)
		//判断当前窗口内页高度和窗口高度，如果差值大于200，那么呵呵
		fuckyou();
}
</script>
<!--禁止审查代码end-->
</body>
</html>
